<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" name="Author" content="Douglas Lau"/>
	<link href="iris_doc.css" rel="stylesheet" type="text/css"/>
	<title>IRIS Administrator Guide</title>
	<script type="text/javascript" src="admin_guide.js"></script>
</head>

<body>
<div class="sidebar">
  <h1><a id="contents_link" href="#admin_guide">Contents</a></h1>
  <div id="contents_div"><!-- div required for js, DO NOT REMOVE --></div>
  <h2><a id="overview_link" href="#overview">Overview</a></h2>
  <div id="overview_div">
    <h3><a href="#architecture">System Architecture</a></h3>
    <h3><a href="#device_types">Device Types</a></h3>
    <h3><a href="#protocols">Protocols</a></h3>
    <h3><a href="#advanced_features">Advanced Features</a></h3>
  </div>
  <h2><a id="installation_link" href="#installation">Installation</a></h2>
  <div id="installation_div">
    <h3><a href="#operating_system">Operating System</a></h3>
    <h3><a href="#install_dependencies">Install Dependencies</a></h3>
    <h3><a href="#install_iris">Install IRIS</a></h3>
    <h3><a href="#authentication_setup">Authentication Setup</a></h3>
    <h3><a href="#database_setup">Database Setup</a></h3>
    <h3><a href="#service_configuration">Service Configuration</a></h3>
    <h3><a href="#start_services">Start Services</a></h3>
  </div>
  <h2><a id="basic_setup_link" href="#basic_setup">Basic Setup</a></h2>
  <div id="basic_setup_div">
    <h3><a href="#system_attributes">System Attributes</a></h3>
    <h3><a href="#users_and_roles">Users and Roles</a></h3>
    <h3><a href="#mapping">Mapping</a></h3>
    <h3><a href="#road_modelling">Road Modelling</a></h3>
    <h3><a href="#comm_links">Comm Links</a></h3>
    <h3><a href="#fonts">Fonts</a></h3>
  </div>
  <h2><a id="devices_link" href="#devices">Devices</a></h2>
  <div id="devices_div">
    <h3><a href="#vehicle_detection">Vehicle Detection</a></h3>
    <h3><a href="#cameras_and_video">Cameras and Video</a></h3>
    <h3><a href="#dms">Dynamic Message Signs</a></h3>
    <h3><a href="#lcs">Lane-Use Control Signs</a></h3>
    <h3><a href="#ramp_meters">Ramp Meters</a></h3>
    <h3><a href="#warning_beacons">Warning Beacons</a></h3>
    <h3><a href="#lane_marking">Lane Marking</a></h3>
  </div>
  <h2><a id="features_link" href="#features">Features</a></h2>
  <div id="features_div">
    <h3><a href="#traffic_data_map">Traffic Data Map</a></h3>
    <h3><a href="#incident_management">Incident Management</a></h3>
    <h3><a href="#action_plans">Action Plans</a></h3>
    <h3><a href="#schedules">Date/Time Schedules</a></h3>
    <h3><a href="#metering_strategies">Ramp Metering Strategies</a></h3>
    <h3><a href="#travel_time">Travel Time Estimation</a></h3>
    <h3><a href="#vsa">Variable Speed Advisory</a></h3>
  </div>
  <h2><a id="troubleshooting_link" href="#troubleshooting">Troubleshooting</a></h2>
  <div id="troubleshooting_div">
    <h3><a href="#error_logs">Error Logs</a></h3>
    <h3><a href="#xml_output">Realtime XML Output</a></h3>
    <h3><a href="#event_tables">Database Event Tables</a></h3>
    <h3><a href="#debug_logs">Debug Trace Logs</a></h3>
  </div>
  <h2><a id="maintenance_link" href="#maintenance">Maintenance</a></h2>
  <div id="maintenance_div">
    <h3><a href="#database_backups">Database Backups</a></h3>
    <h3><a href="#iris_upgrades">IRIS Upgrades</a></h3>
    <h3><a href="#system_updates">System Software Updates</a></h3>
    <h3><a href="#monitoring_logs">Monitoring Logs</a></h3>
  </div>
  <h2><a id="development_link" href="#development">Development</a></h2>
  <div id="development_div">
    <h3><a href="#building">Building</a></h3>
    <h3><a href="#history">History</a></h3>
    <h3><a href="#future_plans">Future Plans</a></h3>
    <h3><a href="#contributing">Contributing</a></h3>
    <h3><a href="#coding_style">Coding Style</a></h3>
  </div>
</div>

<div class="mainbar">
<div id="stamp">21 May 2012</div>
<h1 id="admin_guide">IRIS Administrator Guide</h1>

<h2 id="overview">Overview</h2>
<p>
	IRIS is an <a href="http://www.opensource.org/docs/osd">open source</a>
	advanced traffic management system.
	It provides an integrated platform for transportation agencies to
	manage traffic monitoring and control devices.
	The software is written in <a href="http://www.java.com">Java</a> and
	licensed for anyone to use under the
	<a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">GPL</a>.
	In addition, all dependencies required to install and operate an IRIS
	system are available as free software.
	IRIS stands for Intelligent Roadway Information System.
</p>
<p>
	The IRIS software presents an intuitive map-based interface to system
	operators.
	This user interface has been refined over many iterations by getting
	feedback from operators to streamline their workflow.
</p>

<h3 id="architecture">System Architecture</h3>

<svg class="right" xmlns="http://www.w3.org/2000/svg" version="1.1"
     width="640" height="480">
  <title>System Architecture</title>
  <defs>
    <marker id="Arrow1Mend" orient="auto" style="overflow:visible">
      <path d="M 0,0 5,-5 -12.5,0 5,5 0,0 z"
            transform="matrix(-0.4,0,0,-0.4,-4,0)"
            style="stroke:#000;stroke-width:1pt;marker-start:none"/>
    </marker>
  </defs>
  <g style="font-size:20px;font-family:Liberation Sans">
    <text style="font-size:28px">
      <tspan x="384" y="64">IRIS System</tspan>
      <tspan x="384" y="94">Architecture</tspan>
    </text>
    <g transform="translate(112,24)">
      <g style="fill:#c4f9ff;stroke:#000;stroke-width:2">
        <g style="opacity:0.5">
          <rect x="16" y="16" width="200" height="88" ry="8"
                style="opacity:0.5"/>
          <rect x="8" y="8" width="200" height="88" ry="8"/>
        </g>
        <rect x="0" y="0" width="200" height="88" ry="8"/>
      </g>
      <text>
        <tspan x="48" y="48">IRIS Clients</tspan>
      </text>
    </g>
    <g transform="translate(16,176)">
      <rect x="0" y="0" width="176" height="104" ry="8"
        style="fill:#ffe6c4;stroke:#000;stroke-width:2"/>
      <text>
        <tspan x="16" y="40">Apache Server</tspan>
        <tspan x="24" y="60">- Client JARs</tspan>
        <tspan x="24" y="80">- Map Tiles</tspan>
      </text>
    </g>
    <g transform="translate(232,176)">
      <rect x="0" y="0" width="192" height="120" ry="8"
            style="fill:#e2c4ff;stroke:#000;stroke-width:2"/>
      <text>
        <tspan x="40" y="60">IRIS Server</tspan>
      </text>
    </g>
    <g transform="translate(464,208)">
      <rect x="0" y="0" width="160" height="88" ry="8"
        style="fill:#d0ffc4;stroke:#000;stroke-width:2"/>
      <text>
        <tspan x="16" y="40">Authentication</tspan>
        <tspan x="16" y="60">Server (LDAP)</tspan>
      </text>
    </g>
    <g transform="translate(96,360)">
      <g style="fill:#f6ffc4;stroke:#000;stroke-width:2">
        <g style="opacity:0.5">
          <rect x="16" y="16" width="208" height="88" ry="8"
                style="opacity:0.5"/>
          <rect x="8" y="8" width="208" height="88" ry="8"/>
        </g>
        <rect x="0" y="0" width="208" height="88" ry="8"/>
      </g>
      <text>
        <tspan x="16" y="40">Traffic Monitoring</tspan>
        <tspan x="16" y="60">and Control Devices</tspan>
      </text>
    </g>
    <g transform="translate(368,360)">
      <rect x="0" y="0" width="152" height="88" ry="8"
        style="fill:#c4d1ff;stroke:#000;stroke-width:2" />
      <text>
        <tspan x="16" y="40">Database</tspan>
        <tspan x="16" y="60">(PostgreSQL)</tspan>
      </text>
    </g>
    <g style="stroke:#000;stroke-width:2;marker-end:url(#Arrow1Mend)">
      <path d="m 176,112 -32,64"/>
      <path d="m 256,112 32,64"/>
      <path d="m 424,240 40,8"/>
      <path d="m 272,296 -32,64"/>
      <path d="m 368,296 32,64"/>
    </g>
  </g>
</svg>

<p>
	The software has a client/server architecture.
	System configuration data is stored in a
	<a href="http://www.postgresql.org">PostgreSQL</a> database,
	and managed by the IRIS server.
	The server also handles communication with all traffic control and
	data collection devices.
	The client software is distributed by an <a
	href="http://projects.apache.org/projects/http_server.html">Apache</a>
	web server, using Java Web Start.
	All communication between the server and clients is encrypted using
	secure socket layer (SSL).
	The server passes authentication requests off to an external LDAP
	server, allowing IRIS to integrate into an existing authentication
	system.
</p>

<h3 id="device_types">Device Types</h3>
<p>
	IRIS is able to manage several different types of traffic monitoring and
	control devices.
	These include:
</p>
<ul>
	<li>DMS (dynamic message signs) or CMS</li>
	<li>Ramp meters</li>
	<li>VDS (vehicle detection sensors)</li>
	<li>LCS (lane-use control signals)</li>
	<li>CCTV cameras (pan/tilt/zoom)</li>
	<li>Video switchers</li>
	<li>In-road lighting (dynamic striping)</li>
	<li>Warning Beacons</li>
	<li>Precipitation Sensors</li>
</ul>
<h3 id="protocols">Protocols</h3>
<p>
	Many different protocols are supported for communicating with the
	various device types.
	Additional protocols can be added for any existing device type by
	programming a simple driver interface.
	These are some existing protocols:
</p>
<ul>
	<li>NTCIP class A, B and C (DMS)</li>
	<li>DMS-XML (DMS)</li>
	<li>MnDOT 4- and 5-bit (VDS, ramp meters, LCS, beacons, IRL)</li>
	<li>Wavetronix SS105 and SS125 (VDS)</li>
	<li>Canoga Traffic Sensing System (VDS)</li>
	<li>EIS G4 (VDS)</li>
	<li>Pelco D (pan/tilt/zoom)</li>
	<li>Infinova (pan/tilt/zoom)</li>
	<li>AD "manchester" (pan/tilt/zoom)</li>
	<li>Vicon (pan/tilt/zoom)</li>
	<li>Msg Feed (external system DMS messages)</li>
	<li>Pelco Video Switcher</li>
	<li>Vicon Video Switcher</li>
	<li>Optical Scientific ORG-815 (precipitation)</li>
</ul>
<h3 id="advanced_features">Advanced Features</h3>
<p>
	IRIS also contains some higher-level traffic management features:
</p>
<ul>
	<li>Scheduled deployment of control devices</li>
	<li>Continuously updated density, speed and flow maps</li>
	<li>Travel time estimation for traveller information</li>
	<li>Incident management</li>
	<li>Variable speed advisories</li>
	<li>Coordinated ramp metering strategies</li>
</ul>

<h2 id="installation">Installation</h2>
<p/>

<h3 id="operating_system">Operating System</h3>
<p>
	Install <a href="http://fedoraproject.org">Fedora</a> onto the server
	computer.
	Other operating systems, such as Red Hat Enterprise Linux, can also be
	used, but the procedures may vary slightly.
	This machine should have a minimum of 2 GB of RAM and 200 GB hard drive
	storage space.
	The IRIS server does not have a GUI interface, so this computer can be
	set up headless in a server room.
</p>

<h3 id="install_dependencies">Install Dependencies</h3>
<p>
	Install package dependencies, including
	<a href="http://openjdk.java.net">OpenJDK</a>,
	<a href="http://www.postgresql.org">PostgreSQL</a> and
	<a href="http://projects.apache.org/projects/http_server.html">Apache</a>.
	This can be performed with yum by running the following command (as
	root):
</p>
<pre class="code">yum install java-1.6.0-openjdk postgresql-server postgresql-jdbc httpd</pre>

<h3 id="install_iris">Install IRIS</h3>
<p>
	<a href="http://iris.dot.state.mn.us/rpms/">Download</a> and install
	the IRIS package.
	This should be a file called <i>iris-xx.yy.zz-bb.aa.rpm</i>, with
	<i>xx</i> indicating the major version, <i>yy</i> minor, <i>zz</i>
	micro, and <i>bb</i> the build version.
	The system architecture, <i>aa</i>, will be either <i>i386</i> (32-bit)
	or <i>x86_64</i> (64-bit).
	It can be installed with the following command (as root):
</p>
<pre class="code">rpm -i iris-xx.yy.zz-bb.aa.rpm</pre>
<p>
	Next, you must initialize the IRIS server installation.
	This will create a SSL key pair for encrypted communication between the
	server and clients.
	You will be prompted for a Distinguished Name to use while
	creating a new self-signed certificate.
	Run the following command (as root):
</p>
<pre class="code">service iris init</pre>

<h3 id="authentication_setup">Authentication Setup</h3>
<p>
	Setup an LDAP server for user authentication.
	If your organization already has an LDAP server, such as Active
	Directory, you should use that.
	This will allow operators to log into IRIS without requiring them to
	remember an additional user name and password.
	Otherwise, you can install and configure
	<a href="http://www.openldap.org">OpenLDAP</a>.
	For testing, IRIS also has an option to bypass all authentication
	(no LDAP server required).
</p>
<p>
	IRIS can also be configured to use multiple LDAP servers at once.
	When a user attempts to log in, each defined LDAP server will be
	checked, in order, until authentication succeeds.
	If authentication fails on all LDAP servers, then login will fail.
</p>
<p>
	Using a text editor, open the <i>/etc/iris/iris-server.properties</i>
	file.
	Locate the line which starts with <i>sonar.ldap.urls</i>.
	Change the value of this property to the URL(s) of your LDAP server(s).
	Multiple URLs must be separated by a space.
	The URL protocol is normally <i>ldap:</i>, but must be <i>ldaps:</i>
	for encrypted communication over SSL.
	For testing and debugging only, the <i>sonar.ldap.urls</i> property
	may be set to bypass_authentication.
	This allows anyone to connect to the IRIS server without a password.
	WARNING: Do not use this option on a production system.
</p>
<p>
	(Optional)
	If your LDAP server is configured to use SSL for authentication, then
	you must import the certificate into the IRIS keystore.
	Once you have obtained the SSL certificate, save it as <i>ldap.cert</i>.
	Now you can import it with the following command (as root):
</p>
<pre class="code">keytool -import -alias ldap-cert -keystore /etc/iris/iris-server.keystore -file ldap.cert</pre>

<h3 id="database_setup">Database Setup</h3>
<p>
	The PostgreSQL database must be initialized before use.
	This can be accomplished with the following command (as root):
</p>
<pre class="code">service postgresql initdb</pre>
<p>
	Now, the database must be configured to allow the IRIS server to
	connect using a local TCP socket.
	Edit the <i>/var/lib/pgsql/data/pg_hba.conf</i> file so that it includes
	the following line:
</p>
<pre class="code">host    all         all         127.0.0.1/32          password</pre>
<p>
	NOTE: The "password" in the above line indicates an authentication
	method, not an actual password.
	This allows TCP connections from the local host to connect to the
	database using password authentication, as the IRIS server must.
</p>
<p>
	The PostgreSQL server can now be started:
</p>
<pre class="code">service postgresql start</pre>
<p>
	IRIS uses the PostgreSQL JDBC driver to access the database.
	This driver needs to be added to the java classpath.
	Run the following command (as root):
</p>
<pre class="code">ln -snf /usr/share/java/postgresql-jdbc.jar /usr/lib/jvm/jre/lib/ext/</pre>
<p>
	The <i>tms</i> user account is used by IRIS to connect to the PostgreSQL
	database.
	Run the following commands to configure this account:
</p>
<pre class="code">su postgres
createuser -S -D -R -W tms
exit</pre>
<p>
	You will be prompted for a password when running createuser.
	This same password must also be entered in the
	<i>/etc/iris/iris-server.properties</i> file.
	Open the file in a text editor and locate the line starting with
	#db.password.
	Remove the <i>#</i> and change the password to match.
</p>
<p>
	A database template must now be loaded with all the table definitions
	that IRIS needs.
	The following commands will create the <i>tms</i> database and
	populate it with the template:
</p>
<pre class="code">su postgres
createdb tms
psql tms -f /var/lib/iris/sql/tms-template.sql
exit</pre>
<p>
	A valid LDAP user must be added to the database to allow an initial
	administrator login.
	Run the following commands, replacing the bold values with the user's
	information:
</p>
<pre class="code">su tms
psql tms
INSERT INTO iris.i_user (name, full_name, dn, role, enabled)
	VALUES('<b>name</b>', '<b>full_name</b>', '<b>dn</b>',
	'administrator', true);
\q
exit
</pre>

<h3 id="service_configuration">Service Configuration</h3>
<p>
	The PostgreSQL, Apache and IRIS services should be configured to start
	when the operating system is rebooted.
	To do this, run following commands (as root):
</p>
<pre class="code">chkconfig postgresql on
chkconfig httpd on
chkconfig iris on</pre>

<h3 id="start_services">Start Services</h3>
<p>
	Finally, the Apache web server and the IRIS server can now be started
	with the following commands:
</p>
<pre class="code">service httpd start
service iris start</pre>
<p>
	Check that everything started OK:
</p>
<pre class="code">tail -f -n 40 /var/log/iris/iris.stderr</pre>
<p>
	From a client computer with Java installed, point your web browser at
	http://YOUR_SERVER_NAME/iris-client/.
	From there, you should be able to launch the IRIS client Web Start
	application and log in.
</p>

<h2 id="basic_setup">Basic Setup</h2>
<br/>

<h3 id="system_attributes">System Attributes</h3>
<p>
	A <b>system attribute</b> is a configurable value which can be used to
	customize an IRIS system.
	Select the <code>View ➔ System ➔ System Attributes</code> menu item to
	display the System Attributes form.
	Each system attribute has a corresponding type: string, boolean,
	integer or floating point number.
	String values are limited to 64 characters or less.
	Boolean values must be specified as either "true" or "false".
	Many numeric system attributes are constrained to a range of values
	within a minimum and maximum bound, depending on the attribute.
	A system attribute can be customized by updating the value in the table
	on the System Attributes form.
	When a system attribute has been modified from its default value, it
	will be displayed <b>in bold</b>.
	Most attribute changes take effect immediately, but some require the
	IRIS client or server to be restarted.
</p>

<h3 id="users_and_roles">Users and Roles</h3>
FIXME

<h3 id="mapping">Mapping</h3>
<p>
	The IRIS client can use map tiles to display high-quality maps as a
	background layer.
	The map tiles are fetched from a web server on demand as the client map
	is panned and zoomed.
	The tiles can be generated from data downloaded from
	<a href="http://openstreetmap.org">OpenStreetMap</a>.
	The following instructions describe one method of generating the map
	tiles.
	(FIXME: needs work).
</p>

<h4>Get planet file</h4>
<p>
	Download latest planet file from
	http://planet.openstreetmap.org/planet-latest.osm.bz2 (use wget -- this
	will take a *long* time).
</p>

<h4>Download and install PostGIS</h4>
<p>
	FIXME (need details).
</p>

<h4>Get osm2pgsql dependencies</h4>
<p>
	Install dependencies for building <a href="http://wiki.openstreetmap.org/wiki/Osm2pgsql#Fedora">osm2pgsql</a>.
</p>

<pre class="code">yum install geos-devel proj-devel postgresql-devel libxml2-devel bzip2-devel gcc-c++ autoconf automake libtool</pre>

<h4>Build osm2pgsql</h4>
<p>
	Download osm2pqsql using subversion and build.  (see
	http://wiki.openstreetmap.org/wiki/Osm2pgsql#From_source_.28generic.29)
</p>

<h4>Set bounding box</h4>
<p>
	Determine bounding box of region of interest (for Minnesota, it is
	-97.5, 43.0, -89.0, 49.5).
</p>

<h4>Import planet data into PostGIS</h4>
<pre class="code">
osm2pgsql -d gis -s --bbox -97.5,43.0,-89.0,49.5 mapping/planet-latest.osm.bz2
</pre>

<h4>Install mapnik</h4>
<p>
	Install mapnik, mapnik-python, mapnik-utils.
</p>

<h4>Export osm mapnik stuff</h4>
<pre class="code">
svn export http://svn.openstreetmap.org/applications/rendering/mapnik osm-mapnik
</pre>

<h4>Patch osm.xml to create iris_osm.xml</h4>

<pre class="code">
cd osm-mapnik/
cp osm.xml iris_osm.xml
patch -p0 &lt; ../01_drop_junc_power_layers.patch
patch -p0 &lt; ../02_interstate_shields.patch
patch -p0 &lt; ../03_trunk_shields.patch
patch -p0 &lt; ../04_cty_rd_shields.patch
patch -p0 &lt; ../05_motorway_color.patch
patch -p0 &lt; ../06_trunk_color.patch
patch -p0 &lt; ../07_primary_color.patch
patch -p0 &lt; ../08_secondary_color.patch
patch -p0 &lt; ../09_tertiary_color.patch
</pre>

<h4>Copy symbols used for roadway shields</h4>
<p/>

<h4>Generate map tiles</h4>
<p/>

<h4>Create Map Extents</h4>
<p>
	In the IRIS client, select the <code>View ➔ System ➔ Map Extents</code>
	menu item to bring up the Map Extents form.
	This form enables the creatiion of map extents, which are buttons
	allowing quick selection of a map location and zoom level.
	Each map extent will be displayed as a button on the upper right area
	of the map (next to the zoom in/out buttons).
	First, a "Home" extent should be created, which is selected by default
	when a user logs in.
	Other extents can also be created for commonly selected map spots.
</p>

<h3 id="road_modelling">Road Modelling</h3>
<p>
	For many of the <a href="#features">features</a> IRIS provides, it
	requires a model of the road network topology.
	This model consists of a set of roadway nodes, or <b>r_node</b>s, which
	describe all the points of interest on the road network.
	For instance, each entrance or exit ramp, detector station or
	intersection would be represented by an r_node.
</p>
<h4>Road Setup</h4>
<p>
	Before creating the r_nodes, some roads must be created.
	Select the <code>View ➔ System ➔ Roads</code> menu item to bring up the
	Roads form.
	To create a new road, select the last (empty) cell in the Road column
	and type the name of the road.
	This name can be up to 20 characters in length, and uniquely identifies
	the road.
	It's a good idea to capitalize each word, and abbreviate any
	designators — for example, "Main St".
</p>
<p>
	The next column is "Abbrev".
	Here, an abbreviation of up to 6 characters can be entered.
	This is used for labelling detectors and stations.
</p>
<p>
	The "Road Class" determines the presentation of the road on the map.
	For example, a road marked "Freeway" would be drawn thicker and more
	prominent than an "Expressway" or "Arterial".
</p>
<p>
	"Direction" and "Alt Dir" determine the primary and secondary compass
	directions of the road.
</p>
<h4>R_Node Setup</h4>
<p>
	The most important attribute of an r_node is the location.
	The location is described by the road, direction-of-travel, nearest
	cross-street, and coordinates.
</p>
<p>
	A <b>corridor</b> is an ordered list of all r_nodes associated with a
	road and direction-of-travel.
	The r_nodes in a corridor are put in order based on their coordinates.
</p>

<h3 id="comm_links">Comm Links</h3>
<p>
	A <b>comm link</b> is a network connection to an external device or
	system.
	IRIS is capable of supporting hundreds of simultaneous comm links.
	The comm link interface is found on the <code>View ➔ Maintenance
	➔ Comm Links</code> menu item.
	Each comm link has a number of attributes, including URI and protocol.
</p>
<p>
	The URI includes a DNS host name or network IP address, and port number,
	using the standard "host:port" convention.
	The URI can also contain an optional "scheme" prefix, which can be
	either "udp://", "tcp://" or "modem://".
	If present, the scheme will override the default URI scheme for the
	selected protocol.
	For example, to use the Pelco D protocol over TCP (instead of the
	default UDP), add a "tcp://" scheme prefix to the URI.
</p>
<p>
	The protocol determines what type of device or system is on the other
	end of the comm link.
	The following table contains the communication protocols supported by
	IRIS.
</p>
<table>
	<tr>
	    <th>Protocol</th>
	    <th>Description</th>
	    <th>Default Scheme</th>
	</tr>
	<tr>
	    <td>NTCIP Class A</td>
	    <td><a href="#dms_control">DMS control</a> (no HDLC)</td>
	    <td>UDP</td>
	</tr>
	<tr>
	    <td>NTCIP Class B</td>
	    <td><a href="#dms_control">DMS control</a> over serial (HDLC)</td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>NTCIP Class C</td>
	    <td><a href="#dms_control">DMS control</a> (no HDLC)</td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>DMS XML</td>
	    <td><a href="#dms_control">DMS control</a> to external system</td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>Msg feed</td>
	    <td><a href="#msg_feed">DMS messages</a> from external system</td>
	    <td>TCP / HTTP</td>
	</tr>
	<tr>
	    <td>MnDOT 170 4</td>
	    <td><a href="#vds">VDS</a>,
	        <a href="#meter_protocols">metering</a>
	    </td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>MnDOT 170 5</td>
	    <td><a href="#vds">VDS</a>,
	        <a href="#meter_protocols">metering</a>
	    </td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>Canoga</td>
	    <td><a href="#vds">VDS</a> (GTT Canoga Traffic Sensing System)</td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>SS105</td>
	    <td><a href="#vds">VDS</a> (original Wavetronix SmartSensor)</td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>SS125</td>
	    <td><a href="#vds">VDS</a> (Wavetronix SmartSensor HD)</td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>EIS G4</td>
	    <td><a href="#vds">VDS</a> (EIS G4 sensor)</td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>Pelco D</td>
	    <td><a href="#ptz">PTZ</a> for Pelco cameras</td>
	    <td>UDP</td>
	</tr>
	<tr>
	    <td>Manchester</td>
	    <td><a href="#ptz">PTZ</a> for AD cameras</td>
	    <td>UDP</td>
	</tr>
	<tr>
	    <td>Vicon</td>
	    <td><a href="#ptz">PTZ</a> for Vicon cameras</td>
	    <td>UDP</td>
	</tr>
	<tr>
	    <td>Infinova</td>
	    <td><a href="#ptz">PTZ</a> for Infinova cameras</td>
	    <td>UDP</td>
	</tr>
	<tr>
	    <td>Vicon Switcher</td>
	    <td>Video switching for Vicon</td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>Pelco Switcher</td>
	    <td>Video switching for Pelco</td>
	    <td>TCP</td>
	</tr>
	<tr>
	    <td>Org 815</td>
	    <td>RWIS (ORG 815 sensor)</td>
	    <td>TCP</td>
	</tr>
</table>
<p/>

<h4 id="dms_control">DMS Control Protocols</h4>
<p>
	These protocols are used to communicate with DMS controllers in the
	field.
	They enable the following:
</p>
<ul>
	<li>Querying configuration information</li>
	<li>Querying diagnostic information</li>
	<li>Sending fonts and graphics</li>
	<li>Querying currently displayed message</li>
	<li>Displaying new messages</li>
</ul>

<h4 id="msg_feed">DMS Msg Feed Protocol</h4>
<p>
	The "msg feed" protocol can be used to interface IRIS with an external
	system that generates <a href="#dms">DMS</a> messages.
	Periodically, IRIS will poll the URI (using HTTP) for DMS messages.
	The external system should respond with an ASCII text file, with one
	line per message to be deployed.
</p>
<p>
	Each line must contain 3 fields, separated by tab characters "\t"
	(ASCII 0x09), and terminated with a single newline character "\n"
	(ASCII 0x0A).
	The fields are DMS name, <a href="#multi">MULTI</a> string, and
	expiration time.
	The DMS name must exactly match one of the DMS as identified by IRIS.
	The MULTI string specifies a message to display on the sign, using the
	MULTI markup language, from NTCIP 1203.
	For example, "ROAD CLOSED[nl]AHEAD[nl]LEFT LANE CLOSED" is a valid
	three-line MULTI message.
	The expiration field indicates the date and time that the message
	should expire.
	It is in "yyyy-MM-dd HH:mm:ssZ" format, which includes date, time and
	time zone.
	A valid expiration time would be 2012-05-15 11:37:00-0600.
</p>
<p>
	There are a couple of other required steps to enable a message feed
	to operate.
	First, an action plan must be created which associates a DMS action
	with the message feed.
	The DMS action must be associated with a quick message that references
	the message feed, using a special MULTI tag.
	So, if the message feed is on a Comm Link called "LFEED", then the
	quick message MULTI string must be "[feedLFEED]".
	Also, the action plan must be active and deployed.
	This requirement allows only administrator-approved DMS to be controlled
	by the message feed.
</p>
<p>
	The other requirement for message feeds is that all messages used by
	the feed must be defined in the DMS message library.
	This requirement allows only administrator-approved messages to be
	deployed by the message feed.
	In some circumstances, it may be appropriate to disable this checking.
	For example, if the message feed host is fully trusted and there is no
	possibility of man-in-the-middle attacks between IRIS and the feed host.
	In this case the "msg_feed_verify" <a href="#system_attributes">system
	attribute</a> can be set to "false" to disable this check.
</p>

<h4 id="vds">VDS Protocols</h4>
<p>
	These protocols allow IRIS to collect traffic data from vehicle
	detection systems.
	In most cases, this allows volume, occupancy and even speed to be
	collected for the most recent time period bin.
	Others allow recording timestamps and headway for each vehicle passing
	by the sensor.
	Some protocols allow the time binning period to be adjusted.
	The following table summarizes features of each protocol.
</p>
<table>
	<tr>
	    <th>Protocol</th>
	    <th>Addressing</th>
	    <th>Binning</th>
	    <th>Speed</th>
	</tr>
	<tr>
	    <th>MnDOT 170 4</th>
	    <td>4-bit (1-15)</td>
	    <td>30 seconds (+5 minute)</td>
	    <td>No</td>
	</tr>
	<tr>
	    <th>MnDOT 170 5</th>
	    <td>5-bit (1-31)</td>
	    <td>30 seconds (+5 minute)</td>
	    <td>No</td>
	</tr>
	<tr>
	    <th>Canoga</th>
	    <td>8-bit (1-255)</td>
	    <td>No (vehicle logging)</td>
	    <td>Double loops only</td>
	</tr>
	<tr>
	    <th>SS105</th>
	    <td>4-digit (0001-9999)</td>
	    <td>5 seconds to 1 month</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <th>SS125</th>
	    <td>32-bit (0-65535)</td>
	    <td>???</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <th>EIS G4</th>
	    <td>32-bit (0-65535)</td>
	    <td>???</td>
	    <td>Yes</td>
	</tr>
</table>
<p/>

<h4 id="meter_protocols">Ramp Metering Protocols</h4>
<p>
	These protocols are used to control ramp meters in the field.
	They enable the following:
</p>
<ul>
	<li>Activating and deactivating meter</li>
	<li>Adjusting meter release rate</li>
	<li>Querying meter status</li>
	<li>Querying green counts</li>
	<li>Synchronizing clock</li>
	<li>Configuring time-of-day operation</li>
</ul>

<h4 id="ptz">CCTV PTZ Protocols</h4>
<p>
	These protocols are used to control the pan/tilt/zoom functions of
	closed-circuit television cameras.
	They enable the following:
</p>
<ul>
	<li>Panning / tilting the camera</li>
	<li>Zooming in or out</li>
	<li>Recall preset positions</li>
	<li>Store preset positions</li>
</ul>

<h4>Video Switching Protocols</h4>
FIXME

<h4>RWIS Protocols</h4>
FIXME

<h3 id="fonts">Fonts</h3>
<p>
	A font is a set of bitmapped glyphs for displaying text on a dynamic
	message sign (DMS).
	Each font can contain any of the characters in the ASCII character set.
</p>
<p>
	When selecting a font, a few parameters must be considered, such as
	pixel pitch, desired character height, and font weight.
	Pixel pitch can vary from 66 mm down to 20 mm or smaller.
	Typically, for freeway signs, characters should be between 350 and 400
	mm (about 14 or 15 inches) high.
	See the table below for character heights based on these common sizes.
</p>
<table>
	<tr>
	    <th rowspan='2'>Font Height</th>
	    <th colspan='4'>Pixel Pitch</th>
	</tr>
	<tr>
	    <th>20 mm</th>
	    <th>33 mm</th>
	    <th>50 mm</th>
	    <th>66 mm</th>
	</tr>
	<tr>
	    <th>7 px</th>
	    <td>120 mm</td>
	    <td>198 mm</td>
	    <td>300 mm</td>
	    <td class='best'>396 mm</td>
	</tr>
	<tr>
	    <th>8 px</th>
	    <td>140 mm</td>
	    <td>231 mm</td>
	    <td class='best'>350 mm</td>
	    <td>462 mm</td>
	</tr>
	<tr>
	    <th>10 px</th>
	    <td>180 mm</td>
	    <td>297 mm</td>
	    <td>450 mm</td>
	    <td>594 mm</td>
	</tr>
	<tr>
	    <th>12 px</th>
	    <td>220 mm</td>
	    <td class='best'>363 mm</td>
	    <td>550 mm</td>
	    <td>726 mm</td>
	</tr>
	<tr>
	    <th>14 px</th>
	    <td>260 mm</td>
	    <td>429 mm</td>
	    <td>650 mm</td>
	    <td>858 mm</td>
	</tr>
	<tr>
	    <th>16 px</th>
	    <td>300 mm</td>
	    <td>495 mm</td>
	    <td>750 mm</td>
	    <td>990 mm</td>
	</tr>
	<tr>
	    <th>18 px</th>
	    <td>340 mm</td>
	    <td>561 mm</td>
	    <td>850 mm</td>
	    <td>1122 mm</td>
	</tr>
	<tr>
	    <th>20 px</th>
	    <td class='best'>380 mm</td>
	    <td>627 mm</td>
	    <td>950 mm</td>
	    <td>1254 mm</td>
	</tr>
</table>
<p>
	In the past, DMS have been used with upper-case only fonts, but with
	smaller pixel pitch, it is possible to create legible fonts which
	also include lower-case characters.
	If a message containing lower-case characters is used with an upper-case
	only font, IRIS will replace those characters with their equivalent.
</p>
<p>
	Several sample fonts are included with IRIS as SQL scripts.
	They can be imported from the command line (bash) into an IRIS database
	with a command such as:
</p>
<pre class="code">psql tms -f /var/lib/iris/sql/fonts/F12_S2x1.sql</pre>
<p>
	The IRIS server will have to be restarted to have access to the imported
	font.
</p>

<h2 id="devices">Devices</h2>
<br/>

<h3 id="vehicle_detection">Vehicle Detection</h3>
FIXME

<h3 id="cameras_and_video">Cameras and Video</h3>
FIXME

<h3 id="dms">Dynamic Message Signs (DMS)</h3>

<h4>DMS Setup</h4>
FIXME

<h4 id="multi">MULTI (Markup Language for Transpostation Information)</h4>
<p>
	DMS messages are specified using <b>MULTI</b>, as defined by the
	NTCIP 1203 standard.
	In MULTI, messages are simple ASCII strings, with formatting or other
	instructions denoted by tags inside square brackets.
	For example, the tag <code>[nl]</code> indicates a new line.
	Most of the useful standard MULTI tags are supported, as well as a few
	whch are specific to IRIS.
	The following table summarizes the tags supported by IRIS.
</p>
<table>
	<tr>
	    <th>Tag</th>
	    <th>Description</th>
	    <th>Supported</th>
	</tr>
	<tr>
	    <td>[cb<i>x</i>]</td>
	    <td>Message background color</td>
	    <td>No</td>
	</tr>
	<tr>
	    <td>[pb<i>r</i>,<i>g</i>,<i>b</i>]</td>
	    <td>Page background color</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <td>[cf<i>r</i>,<i>g</i>,<i>b</i>]</td>
	    <td>Foreground color</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <td>[cr<i>x</i>,<i>y</i>,<i>w</i>,<i>h</i>,<i>r</i>,<i>g</i>,<i>b</i>]</td>
	    <td>Color rectangle</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <td>[f<i>x</i>,<i>y</i>]</td>
	    <td>Field data</td>
	    <td>No</td>
	</tr>
	<tr>
	    <td>[flt<i>x</i>o<i>y</i>]</td>
	    <td rowspan="2">Flashing text</td>
	    <td rowspan="2">No</td>
	</tr>
	<tr>
	    <td>[flo<i>y</i>t<i>x</i>]</td>
	</tr>
	<tr>
	    <td>[fo<i>x</i>]</td>
	    <td rowspan="2">Change font</td>
	    <td rowspan="2">Yes</td>
	</tr>
	<tr>
	    <td>[fo<i>x</i>,<i>cccc</i>]</td>
	</tr>
	<tr>
	    <td>[g<i>n</i>]</td>
	    <td rowspan="3">Place graphic</td>
	    <td rowspan="3">Yes</td>
	</tr>
	<tr>
	    <td>[g<i>n</i>,<i>x</i>,<i>y</i>]</td>
	</tr>
	<tr>
	    <td>[g<i>n</i>,<i>x</i>,<i>y</i>,<i>cccc</i>]</td>
	</tr>
	<tr>
	    <td>[hc<i>n</i>]</td>
	    <td>Hexadecimal character</td>
	    <td>No</td>
	</tr>
	<tr>
	    <td>[jl<i>n</i>]</td>
	    <td>Line justification</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <td>[jp<i>n</i>]</td>
	    <td>Page justification</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <td>[ms<i>x</i>,<i>y</i>]</td>
	    <td>Manufacturer specific</td>
	    <td>No</td>
	</tr>
	<tr>
	    <td>[mv<i>...</i>]</td>
	    <td>Moving text</td>
	    <td>No</td>
	</tr>
	<tr>
	    <td>[nl]</td>
	    <td rowspan="2">New line</td>
	    <td rowspan="2">Yes</td>
	</tr>
	<tr>
	    <td>[nl<i>s</i>]</td>
	</tr>
	<tr>
	    <td>[np]</td>
	    <td>New page</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <td>[pt<i>n</i>]</td>
	    <td rowspan="2">Page time</td>
	    <td rowspan="2">Yes</td>
	</tr>
	<tr>
	    <td>[pt<i>n</i>o<i>f</i>]</td>
	</tr>
	<tr>
	    <td>[sc<i>x</i>]</td>
	    <td>Character spacing</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <td>[tr<i>x</i>,<i>y</i>,<i>w</i>,<i>h</i>]</td>
	    <td>Text rectangle</td>
	    <td>Yes</td>
	</tr>
	<tr>
	    <td>[tt<i>n</i>]</td>
	    <td>Travel time</td>
	    <td>IRIS-only</td>
	</tr>
	<tr>
	    <td>[vsa]</td>
	    <td>Speed advisory</td>
	    <td>IRIS-only</td>
	</tr>
	<tr>
	    <td>[feed<i>n</i>]</td>
	    <td><a href="#msg_feed">Message feed</a></td>
	    <td>IRIS-only</td>
	</tr>
</table>

<h3 id="lcs">Lane-Use Control Signs</h3>
FIXME

<h3 id="ramp_meters">Ramp Meters</h3>
FIXME

<h3 id="warning_beacons">Warning Beacons</h3>
FIXME

<h3 id="lane_marking">Lane Marking</h3>
FIXME

<h2 id="features">Features</h2>

<h3 id="traffic_data_map">Traffic Data Map</h3>
FIXME

<h3 id="incident_management">Incident Management</h3>
FIXME

<h3 id="action_plans">Action Plans</h3>
FIXME

<h3 id="schedules">Date/Time Schedules</h3>
FIXME

<h3 id="metering_strategies">Ramp Metering Strategies</h3>
FIXME

<h3 id="travel_time">Travel Time Estimation</h3>
FIXME

<h3 id="vsa">Variable Speed Advisory</h3>
FIXME

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="error_logs">Error Logs</h3>
FIXME

<h3 id="xml_output">Realtime XML Output</h3>
FIXME

<h3 id="event_tables">Database Event Tables</h3>
FIXME

<h3 id="debug_logs">Debug Trace Logs</h3>
FIXME

<h2 id="maintenance">Maintenance</h2>
<p>
	Once an IRIS system is set up, there are a few maintenance tasks which
	need to be done to ensure reliable operation.
</p>
<h3 id="database_backups">Database Backups</h3>
FIXME

<h3 id="iris_upgrades">IRIS Upgrades</h3>
FIXME

<h3 id="system_updates">System Software Updates</h3>
FIXME

<h3 id="monitoring_logs">Monitoring Logs</h3>
FIXME

<h2 id="development">Development</h2>

<h3 id="building">Building</h3>
<p>
	Install <a href="http://fedoraproject.org">Fedora</a> onto the
	development system.
	Some additional development packages must be installed.
</p>
<pre class="code">yum install java-1.6.0-openjdk-devel ant-junit mercurial rpm-build gcc gstreamer-java</pre>
<p>
	Create links to gstreamer-java and jna jar files in extension directory.
</p>
<pre class="code">ln -snf /usr/share/java/jna.jar /usr/java/default/jre/lib/ext/
ln -snf /usr/share/java/gstreamer-java.jar /usr/java/default/jre/lib/ext/</pre>
<p>
	In a suitable development directory, clone the iris mercurial
	repository.
</p>
<pre class="code">hg clone http://iris.dot.state.mn.us/hg/index.cgi/iris</pre>
<p>
	Create lib/ directory in iris development repository.
</p>
<pre class="code">mkdir iris/lib/</pre>
<p>
	Download the <a href="http://www.oracle.com/technetwork/java/index-138643.html">JavaMail API</a> from Oracle.
	Unzip the JavaMail archive and locate the mail.jar file.
	Copy the mail.jar file to the lib/ directory in the iris repository.
</p>
<p>
	Copy iris-build.properties from etc/ to lib/.
	Edit lib/iris-build.properties file as necessary for your organization.
</p>
<p>
	Create the key for signing jar packages.
	This is required for Java Web Start, which is used by the IRIS client.
	The key should go into your default keystore (~/.keystore).
</p>
<pre class="code">keytool -genkeypair -alias signing-key</pre>
<p>
	Put the following lines into your ~/.ant.properties file.
</p>
<pre class="code">debug=off
sign.store=${user.home}/.keystore
sign.store.pass=password
sign.alias=signing-key
sign.alias.pass=signing-password
hgbase.url=http://iris.dot.state.mn.us/hg/index.cgi/
</pre>
<p>
	Now, the IRIS rpm file can be build with the following commands.
	(The current directory should be the root of the iris repository.
</p>
<pre class="code">ant rpm</pre>
<p>
	If there are no errors, the new rpm file should be in the
	build/rpm/RPMS/i386/ directory.
</p>

<h3 id="history">History</h3>
FIXME

<h3 id="future_plans">Future Plans</h3>
FIXME

<h3 id="contributing">Contributing</h3>
FIXME

<h3 id="coding_style">Coding Style</h3>
<p>
	The coding style for IRIS is focused on making code more readable.
	Readability is the most important factor for software maintenance,
	and it also helps new developers who are unfamiliar with the codebase.
</p>
<p>
	First and foremost, it is recommended that each method fit in one page
	of text (30 lines by 80 columns).
	Whenever possible, longer methods should be decomposed to abide by this
	recommendation.
	This allows a developer to quickly read and understand the method's
	logic.
	It is much easier to spot and correct bugs in shorter methods.
	There should be no blank lines within a method.
</p>
<p>
	With methods longer than one page, it can be beneficial to have a
	single exit point (return).
	But for shorter methods (always the goal), this is not so important,
	and can reduce readability.
	It doesn't make sense to add a local "ret" variable with a single
	return statement at the end when the whole method can be read at a
	glance.
</p>
<p>
	Each block indent should be 8 columns (using tabs instead of spaces).
	This makes the blocks more obvious, and is easier to read than the 4
	spaces commonly used in other Java projects.
	Always use an indented block with if, for, while, etc. statements.
	This makes it much easier to follow the control flow than when it is
	combined onto the same line as the statement.
	Don't put an opening curly brace on a line by itself unless the method
	declaration or loop statement spans multiple lines.
	For single line blocks (if, for, while), do not use curly braces.
</p>
<p>
	Each method should have a javadoc comment describing its purpose.
	All parameters and return values should be documented as well.
	Comments within a method should be used sparingly &mdash; never
	describe what the code is doing, but instead <b>why</b> it was written
	in a certain way.
	Code which is "commented out" should <b>never</b> be committed to a
	repository.
</p>
<p>
	Unary operators, such as ++ -- ! ~ should be adjacent to their operand
	with no space.
	Binary operators, such as + - / * % &amp; | &amp;&amp; || &gt; = &lt;
	&gt;&gt; == != &lt;&lt; &gt;&gt;&gt; &gt;= &lt;= ^ should be separated
	from their operands by a space.
</p>

</div>

</body>
</html>
